<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAD SANTANA | PAINEL DA CÁSSIA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #000; color: #fff; height: 100vh; overflow: hidden; }
        .glass-box { background: #0a0a0a; border: 1px solid #1a1a1a; border-radius: 24px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .input-clean { background: #111; border: 1px solid #222; border-radius: 12px; padding: 12px; font-weight: 600; color: #fff; outline: none; }
        .input-clean:focus { border-color: #fbbf24; background: #161616; }
        .card-registro { background: linear-gradient(to right, #0a0a0a, #000); border: 1px solid #1a1a1a; border-left: 4px solid #fbbf24; border-radius: 16px; transition: 0.3s; }
        .card-registro:hover { transform: scale(1.01); border-color: #333; }
        iframe { width: 100%; height: 100%; border-radius: 16px; background: #000; border: none; }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: #222; border-radius: 10px; }
    </style>
</head>
<body class="p-6">

    <header class="max-w-[1700px] mx-auto flex justify-between items-center mb-8">
        <div class="flex items-center gap-4">
            <div class="bg-amber-500 text-black p-3 rounded-xl shadow-[0_0_20px_rgba(245,158,11,0.2)]">
                <i class="fa-solid fa-gavel text-xl"></i>
            </div>
            <div>
                <h1 class="text-xl font-extrabold uppercase italic tracking-tighter text-white">CAD Santana de Parnaíba</h1>
                <p class="text-[9px] font-black text-amber-500 uppercase tracking-[0.4em] opacity-80">Gestão de Triagem • Cássia</p>
            </div>
        </div>
        
        <div class="flex items-center gap-4">
            <input type="file" id="upEscala" class="hidden" accept="application/pdf" onchange="processarPDF(this)">
            <button onclick="document.getElementById('upEscala').click()" class="bg-white text-black px-8 py-3 rounded-full text-[10px] font-black uppercase hover:bg-amber-500 transition-all active:scale-95 shadow-lg">
                <i class="fa-solid fa-file-arrow-up mr-2"></i> Subir Escala PDF
            </button>
        </div>
    </header>

    <main class="max-w-[1700px] mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8 h-[calc(100vh-140px)]">
        
        <div class="lg:col-span-7 flex flex-col gap-3">
            <span class="text-[9px] font-black text-slate-600 uppercase tracking-widest px-2 italic">Documento Oficial de Fevereiro</span>
            <div class="glass-box flex-grow overflow-hidden relative border-amber-500/10">
                <div id="msgVazio" class="absolute inset-0 flex flex-col items-center justify-center opacity-10">
                    <i class="fa-solid fa-file-invoice text-8xl mb-4"></i>
                    <p class="font-black uppercase tracking-[0.5em]">Aguardando PDF</p>
                </div>
                <iframe id="pdfFrame" class="hidden"></iframe>
            </div>
        </div>

        <div class="lg:col-span-5 flex flex-col gap-6 overflow-hidden">
            
            <div class="glass-box p-8 border-amber-500/10">
                <h2 class="text-[10px] font-black text-amber-500 uppercase tracking-widest mb-6 flex items-center gap-2">
                    <i class="fa-solid fa-pen-to-square"></i> Registrar Substituição Manual
                </h2>
                
                <div class="space-y-4">
                    <div class="flex flex-col gap-1.5">
                        <label class="text-[9px] font-bold text-slate-500 uppercase ml-1">Dia do Plantão</label>
                        <input type="text" id="campoDia" placeholder="Ex: 15/02" class="input-clean">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="flex flex-col gap-1.5">
                            <label class="text-[9px] font-bold text-slate-500 uppercase ml-1">Dra. que SAI</label>
                            <input type="text" id="campoSai" placeholder="Dra. Nome" class="input-clean text-slate-400 font-normal">
                        </div>
                        <div class="flex flex-col gap-1.5">
                            <label class="text-[9px] font-bold text-emerald-500 uppercase ml-1">Dra. que ENTRA</label>
                            <input type="text" id="campoEntra" placeholder="Dra. Nome" class="input-clean border-emerald-900/30">
                        </div>
                    </div>
                    <button onclick="registrar()" class="w-full bg-amber-500 text-black py-4 rounded-xl font-black text-xs uppercase tracking-widest hover:bg-amber-400 transition-all shadow-xl mt-2">
                        Salvar Alteração
                    </button>
                </div>
            </div>

            <div class="flex-grow overflow-y-auto pr-2">
                <div class="flex justify-between items-center mb-4 px-2">
                    <h3 class="text-[10px] font-black text-slate-700 uppercase tracking-widest italic">Trocas Confirmadas</h3>
                    <button onclick="resetar()" class="text-[9px] font-bold text-red-900 hover:text-red-500 uppercase">Limpar</button>
                </div>
                <div id="lista" class="space-y-4"></div>
            </div>
        </div>
    </main>

    <script>
        let trocas = JSON.parse(localStorage.getItem('cad_v50')) || [];

        // FUNÇÃO DE UPLOAD GERAL
        function processarPDF(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    localStorage.setItem('pdf_fevereiro', e.target.result);
                    renderizarPDF();
                };
                reader.readAsDataURL(file);
            }
        }

        function renderizarPDF() {
            const data = localStorage.getItem('pdf_fevereiro');
            if (data) {
                document.getElementById('msgVazio').style.display = 'none';
                const frame = document.getElementById('pdfFrame');
                frame.src = data;
                frame.classList.remove('hidden');
            }
        }

        // REGISTRO 100% MANUAL
        function registrar() {
            const dia = document.getElementById('campoDia').value;
            const sai = document.getElementById('campoSai').value;
            const entra = document.getElementById('campoEntra').value;

            if (dia && sai && entra) {
                trocas.unshift({ id: Date.now(), dia, sai, entra });
                localStorage.setItem('cad_v50', JSON.stringify(trocas));
                
                // Limpar campos
                document.getElementById('campoDia').value = "";
                document.getElementById('campoSai').value = "";
                document.getElementById('campoEntra').value = "";
                
                desenharLista();
            } else {
                alert("Preencha o dia e os nomes das advogadas.");
            }
        }

        function desenharLista() {
            const box = document.getElementById('lista');
            box.innerHTML = trocas.length ? '' : '<p class="text-center py-10 text-white/5 font-black uppercase text-xs tracking-widest">Nenhuma troca registrada</p>';

            trocas.forEach(t => {
                box.innerHTML += `
                    <div class="card-registro p-5 flex items-center justify-between">
                        <div class="flex items-center gap-6">
                            <div class="bg-amber-500 text-black w-14 py-2 rounded-xl text-center font-black">
                                <span class="text-[8px] block leading-none opacity-60">FEV</span>
                                <span class="text-lg leading-none italic">${t.dia}</span>
                            </div>
                            <div class="flex items-center gap-4">
                                <div class="flex flex-col">
                                    <span class="text-[8px] font-bold text-white/20 uppercase tracking-widest">Removida</span>
                                    <span class="text-xs font-bold text-white/40 italic"><s>${t.sai}</s></span>
                                </div>
                                <i class="fa-solid fa-arrow-right text-amber-500/20 text-xs"></i>
                                <div class="flex flex-col">
                                    <span class="text-[8px] font-black text-emerald-500 uppercase tracking-widest">Assume</span>
                                    <span class="text-base font-black text-white italic underline decoration-emerald-500/30">${t.entra}</span>
                                </div>
                            </div>
                        </div>
                        <button onclick="apagar(${t.id})" class="text-white/10 hover:text-red-500 transition-all"><i class="fa-solid fa-xmark"></i></button>
                    </div>
                `;
            });
        }

        function apagar(id) {
            trocas = trocas.filter(x => x.id !== id);
            localStorage.setItem('cad_v50', JSON.stringify(trocas));
            desenharLista();
        }

        function resetar() {
            if(confirm("Deseja apagar o histórico de trocas?")) {
                trocas = []; localStorage.removeItem('cad_v50'); desenharLista();
            }
        }

        window.onload = () => { renderizarPDF(); desenharLista(); };
    </script>
</body>
</html>
