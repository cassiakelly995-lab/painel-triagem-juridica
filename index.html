<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAD SANTANA | GESTÃO DRA. MARISTELA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;700;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #000; color: #fff; height: 100vh; overflow: hidden; }
        .glass-box { background: #0a0a0a; border: 1px solid #1a1a1a; border-radius: 24px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .input-clean { background: #111; border: 1px solid #222; border-radius: 12px; padding: 12px; font-weight: 600; color: #fff; outline: none; transition: 0.2s; }
        .input-clean:focus { border-color: #fbbf24; background: #161616; }
        .card-registro { background: linear-gradient(to right, #0a0a0a, #000); border: 1px solid #1a1a1a; border-left: 4px solid #fbbf24; border-radius: 16px; transition: 0.3s; }
        .card-falta { border-left-color: #ef4444; }
        embed { width: 100%; height: 100%; border-radius: 16px; background: #000; }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: #222; border-radius: 10px; }
    </style>
</head>
<body class="p-6">

    <header class="max-w-[1700px] mx-auto flex justify-between items-end mb-8">
        <div class="flex items-center gap-5">
            <div class="bg-amber-500 text-black p-4 rounded-2xl shadow-[0_0_25px_rgba(245,158,11,0.2)]">
                <i class="fa-solid fa-gavel text-2xl"></i>
            </div>
            <div>
                <h1 class="text-2xl font-extrabold uppercase italic tracking-tighter text-white leading-none">CAD Santana de Parnaíba</h1>
                <p class="text-[10px] font-bold text-amber-500 uppercase tracking-[0.3em] mt-2">
                    Presidência: <span class="text-white">Dra. Maristela Gonçalves</span>
                </p>
                <p class="text-[8px] font-black text-slate-500 uppercase tracking-[0.4em] mt-1">Gestão de Triagem • Admin Cássia</p>
            </div>
        </div>
        
        <div class="flex items-center gap-4">
            <input type="file" id="upEscala" class="hidden" accept="application/pdf" onchange="subirNovoPDF(this)">
            <button onclick="document.getElementById('upEscala').click()" class="bg-white text-black px-8 py-3 rounded-full text-[10px] font-black uppercase hover:bg-amber-400 transition-all active:scale-95 shadow-lg">
                <i class="fa-solid fa-sync mr-2"></i> Atualizar Escala PDF
            </button>
        </div>
    </header>

    <main class="max-w-[1700px] mx-auto grid grid-cols-1 lg:grid-cols-12 gap-8 h-[calc(100vh-160px)]">
        
        <div class="lg:col-span-6 flex flex-col gap-3">
            <span class="text-[9px] font-black text-slate-600 uppercase tracking-widest px-2 italic">Escala de Triagem em Vigência</span>
            <div class="glass-box flex-grow overflow-hidden relative border-amber-500/10" id="containerPDF">
                <div id="msgVazio" class="absolute inset-0 flex flex-col items-center justify-center opacity-10">
                    <i class="fa-solid fa-file-pdf text-8xl mb-4"></i>
                    <p class="font-black uppercase tracking-[0.5em]">Sem PDF carregado</p>
                </div>
            </div>
        </div>

        <div class="lg:col-span-6 flex flex-col gap-6 overflow-hidden">
            <div class="glass-box p-6 border-amber-500/10">
                <div class="flex gap-4 mb-6">
                    <button onclick="aba('troca')" id="btnTroca" class="text-[10px] font-black uppercase tracking-widest pb-2 border-b-2 border-amber-500">Trocas</button>
                    <button onclick="aba('falta')" id="btnFalta" class="text-[10px] font-black uppercase tracking-widest pb-2 border-b-2 border-transparent text-slate-500">Faltas</button>
                </div>
                
                <div id="formTroca" class="space-y-4">
                    <div class="grid grid-cols-3 gap-3">
                        <input type="text" id="tDia" placeholder="Dia" class="input-clean">
                        <input type="text" id="tSai" placeholder="Dra. que SAI" class="input-clean text-slate-500">
                        <input type="text" id="tEntra" placeholder="Dra. que ENTRA" class="input-clean border-emerald-900/20">
                    </div>
                    <button onclick="registrarTroca()" class="w-full bg-amber-500 text-black py-3 rounded-xl font-black text-[10px] uppercase hover:bg-amber-400">Salvar Registro</button>
                </div>

                <div id="formFalta" class="hidden space-y-4">
                    <div class="grid grid-cols-2 gap-3">
                        <input type="text" id="fDia" placeholder="Dia" class="input-clean">
                        <input type="text" id="fNome" placeholder="Nome da Advogada" class="input-clean border-red-900/20">
                    </div>
                    <button onclick="registrarFalta()" class="w-full bg-red-600 text-white py-3 rounded-xl font-black text-[10px] uppercase hover:bg-red-500">Registrar Falta</button>
                </div>
            </div>

            <div class="flex-grow overflow-y-auto pr-2">
                <div id="lista" class="space-y-3"></div>
            </div>
        </div>
    </main>

    <script>
        let registros = JSON.parse(localStorage.getItem('cad_final_v1')) || [];

        function aba(tipo) {
            document.getElementById('formTroca').classList.toggle('hidden', tipo !== 'troca');
            document.getElementById('formFalta').classList.toggle('hidden', tipo !== 'falta');
            document.getElementById('btnTroca').className = tipo === 'troca' ? 'text-[10px] font-black uppercase tracking-widest pb-2 border-b-2 border-amber-500' : 'text-[10px] font-black uppercase tracking-widest pb-2 border-b-2 border-transparent text-slate-500';
            document.getElementById('btnFalta').className = tipo === 'falta' ? 'text-[10px] font-black uppercase tracking-widest pb-2 border-b-2 border-red-500 text-red-500' : 'text-[10px] font-black uppercase tracking-widest pb-2 border-b-2 border-transparent text-slate-500';
        }

        function subirNovoPDF(input) {
            const file = input.files[0];
            if (file) {
                localStorage.removeItem('pdf_data_final');
                const reader = new FileReader();
                reader.onload = (e) => {
                    const base64 = e.target.result;
                    localStorage.setItem('pdf_data_final', base64);
                    exibirPDF(base64);
                };
                reader.readAsDataURL(file);
            }
        }

        function exibirPDF(base64Data) {
            const pdfData = base64Data || localStorage.getItem('pdf_data_final');
            if (pdfData) {
                document.getElementById('msgVazio').classList.add('hidden');
                const container = document.getElementById('containerPDF');
                const byteCharacters = atob(pdfData.split(',')[1]);
                const byteNumbers = new Array(byteCharacters.length);
                for (let i = 0; i < byteCharacters.length; i++) byteNumbers[i] = byteCharacters.charCodeAt(i);
                const byteArray = new Uint8Array(byteNumbers);
                const blob = new Blob([byteArray], {type: 'application/pdf'});
                const url = URL.createObjectURL(blob);
                container.innerHTML = `<embed src="${url}#toolbar=0" type="application/pdf" width="100%" height="100%">`;
            }
        }

        function registrarTroca() {
            const dia = document.getElementById('tDia').value;
            const sai = document.getElementById('tSai').value;
            const entra = document.getElementById('tEntra').value;
            if (dia && sai && entra) {
                registros.unshift({ id: Date.now(), tipo: 'troca', dia, sai, entra });
                salvar();
                document.getElementById('tDia').value = ""; document.getElementById('tSai').value = ""; document.getElementById('tEntra').value = "";
            }
        }

        function registrarFalta() {
            const dia = document.getElementById('fDia').value;
            const nome = document.getElementById('fNome').value;
            if (dia && nome) {
                registros.unshift({ id: Date.now(), tipo: 'falta', dia, nome });
                salvar();
                document.getElementById('fDia').value = ""; document.getElementById('fNome').value = "";
            }
        }

        function salvar() {
            localStorage.setItem('cad_final_v1', JSON.stringify(registros));
            renderLista();
        }

        function renderLista() {
            const box = document.getElementById('lista');
            box.innerHTML = registros.length ? '' : '<p class="text-center py-10 text-white/5 font-black uppercase text-xs">Sem ocorrências registradas</p>';
            registros.forEach(r => {
                if(r.tipo === 'troca') {
                    box.innerHTML += `<div class="card-registro p-4 flex items-center justify-between"><div class="flex items-center gap-4"><div class="bg-amber-500 text-black w-12 py-1.5 rounded-lg text-center font-black text-sm italic">${r.dia}</div><div class="flex items-center gap-3"><span class="text-[10px] text-white/30 italic"><s>${r.sai}</s></span><i class="fa-solid fa-right-long text-amber-500/20 text-[10px]"></i><span class="text-sm font-black text-white italic underline decoration-emerald-500/30">${r.entra}</span></div></div><button onclick="apagar(${r.id})" class="text-white/10 hover:text-red-500"><i class="fa-solid fa-xmark"></i></button></div>`;
                } else {
                    box.innerHTML += `<div class="card-registro card-falta p-4 flex items-center justify-between"><div class="flex items-center gap-4"><div class="bg-red-600 text-white w-12 py-1.5 rounded-lg text-center font-black text-sm italic">${r.dia}</div><div class="flex flex-col"><span class="text-[8px] font-black text-red-500 uppercase tracking-widest leading-none mb-1">Falta</span><span class="text-sm font-black text-white italic uppercase">${r.nome}</span></div></div><button onclick="apagar(${r.id})" class="text-white/10 hover:text-red-500"><i class="fa-solid fa-xmark"></i></button></div>`;
                }
            });
        }

        function apagar(id) {
            registros = registros.filter(x => x.id !== id);
            salvar();
        }

        window.onload = () => { exibirPDF(); renderLista(); };
    </script>
</body>
</html>
